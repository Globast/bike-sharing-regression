
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7. Métodos robustos para datos temporales &#8212; Bike Sharing Regression</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"tags": "ams", "useLabelIds": true}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/7_metodos_robustos';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Validación y Selección del Modelo" href="8_validacion_modelo.html" />
    <link rel="prev" title="6. Diagnóstico de supuestos del modelo" href="6_diagnostico_supuestos.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0_prefacio.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/bike.png" class="logo__image only-light" alt="Bike Sharing Regression - Home"/>
    <script>document.write(`<img src="../_static/bike.png" class="logo__image only-dark" alt="Bike Sharing Regression - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0_prefacio.html">
                    Presentación
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Prefacio</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_guia_reproduccion.html">0.1 Guía de reproducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="0_demostraciones.html">0.2 Demostraciones solicitadas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contenido</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_intro_contexto.html">1. Introducción y contexto de movilidad urbana</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_ingenieria_temporal.html">2. Ingenieria de Variables y Procesamiento Temporal</a></li>

<li class="toctree-l1"><a class="reference internal" href="3_exploratorio_temporal.html">3. Análisis exploratorio de series temporales</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_mco_matricial.html">4. Implementación matricial de MCO</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_inferencia_temporal.html">5. Inferencia estadística en datos temporales</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_diagnostico_supuestos.html">6. Diagnóstico de supuestos del modelo</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. Métodos robustos para datos temporales</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_validacion_modelo.html">8. Validación y selección del modelo</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_monte_carlo.html">9. Simulación Monte Carlo</a></li>

<li class="toctree-l1"><a class="reference internal" href="10_interpretacion_operativa.html">10. Interpretación operativa y recomendaciones</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_conclusiones_extensiones.html">11. Conclusiones y extensiones futuras</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_referencias.html">12. Referencias</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/7_metodos_robustos.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>7. Métodos robustos para datos temporales</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-librerias">7.1. Importacion de librerias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-de-datos">7.2. Lectura de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-set-training-and-test">7.3 Split data set (Training and test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#errores-estandar-hac-neweywest">7.4 Errores estándar HAC (Newey–West).</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-hac-neweywest">7.4.1. Método HAC (Newey–West)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-ols">7.4.2. Modelo OLS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-hac">7.4.3. Estimador HAC</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-m-general">7.5.2. Estimador M general</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-de-huber">7.5.3. Estimador de Huber</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-tukey-bisquare-biweight">7.5.4. Estimador Tukey Bisquare (Biweight)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-huber-y-tukey">7.5.5. Metodo Huber y Tukey</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-temporal-moving-block-bootstrap-2000-replicas">7.5.6. Bootstrap temporal (Moving Block Bootstrap) — 2000 réplicas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eleccion-de-la-longitud-de-bloque-ell">7.5.7. Elección de la longitud de bloque  <span class="math notranslate nohighlight">\(\ell\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-comparativa-robustez-de-los-coeficientes-por-metodo">7.5.8. Tabla comparativa, robustez de los coeficientes por metodo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#que-significa-que-un-coeficiente-es-robusto">¿Qué significa que un coeficiente es “robusto”?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criterios-de-robustez-utilizados">7.5.9. ¿Criterios de Robustez utilizados?</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="metodos-robustos-para-datos-temporales">
<h1>7. Métodos robustos para datos temporales<a class="headerlink" href="#metodos-robustos-para-datos-temporales" title="Link to this heading">#</a></h1>
<p>Dado los desarrollos anteriores, se obtuvo que en el modelo de ajuste lineal los errores no satisfacen los supuestos de normalidad y homocedasticidad (varianza costante)<br />
Para lo anterior, en esta seccion estaremos explorando el uso de tecnicas como:</p>
<ol class="arabic simple">
<li><p>Errores estandar HAC (Newey West)</p></li>
<li><p>Estimadores robustos M (Huber, Tukey)</p></li>
<li><p>Boostrap temporal (Block boostrap)</p></li>
</ol>
<section id="importacion-de-librerias">
<h2>7.1. Importacion de librerias<a class="headerlink" href="#importacion-de-librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Librerías científicas básicas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>

<span class="c1"># Visualización</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Modelos estadísticos</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.outliers_influence</span><span class="w"> </span><span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">OLS</span><span class="p">,</span> <span class="n">add_constant</span>
 
<span class="c1"># Machine Learning</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">RFE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lectura-de-datos">
<h2>7.2. Lectura de datos<a class="headerlink" href="#lectura-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/hour_clean.csv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-data-set-training-and-test">
<h2>7.3 Split data set (Training and test)<a class="headerlink" href="#split-data-set-training-and-test" title="Link to this heading">#</a></h2>
<p>En este apartado separaremos los datos en un 70% para entremaniento de los modelos y un 30% para testing de los mismos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="c1">## aqui separamos uno en 70% del data set y otro 30%, la separacion es aleatoria</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tamaño set de entrenemaiento &quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tamaño set de prueba &quot;</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tamaño set de entrenemaiento  (12165, 20)
tamaño set de prueba  (5214, 20)
</pre></div>
</div>
</div>
</div>
</section>
<section id="errores-estandar-hac-neweywest">
<h2>7.4 Errores estándar HAC (Newey–West).<a class="headerlink" href="#errores-estandar-hac-neweywest" title="Link to this heading">#</a></h2>
<section id="metodo-hac-neweywest">
<h3>7.4.1. Método HAC (Newey–West)<a class="headerlink" href="#metodo-hac-neweywest" title="Link to this heading">#</a></h3>
<p>El estimador de <strong>Errores estándar HAC (Heteroskedasticity and Autocorrelation Consistent)</strong> ajusta la matriz de varianzas y covarianzas de los coeficientes OLS para ser robusta frente a heterocedasticidad y autocorrelación.</p>
<section id="modelo-ols">
<h4>7.4.2. Modelo OLS<a class="headerlink" href="#modelo-ols" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
y_t = X_t \beta + u_t
\]</div>
</section>
<section id="estimador-hac">
<h4>7.4.3. Estimador HAC<a class="headerlink" href="#estimador-hac" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
\widehat{V}_{HAC} = (X'X)^{-1} \, \widehat{S} \, (X'X)^{-1}
\]</div>
<p>donde:
$$</p>
<p>\widehat{S} = \sum_{t=1}^{T} \hat{u}_t^2 X_t X_t’</p>
<ul class="simple">
<li><p>\sum_{l=1}^{q} w_l \sum_{t=l+1}^{T} \hat{u}<em>t \hat{u}</em>{t-l}
\big( X_t X_{t-l}’ + X_{t-l} X_t’ \big)</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}#### 7.4.4. Parámetros
- $\hat{u}_t$: residuos estimados del modelo OLS  
- $X_t$: vector de regresores en el tiempo $t$  
- $q$: número de rezagos (`maxlags`) especificado  
- $w_l = 1 - \frac{l}{q+1}$: pesos de Bartlett que decrecen linealmente con el rezago\\#### 7.4.5. Interpretación
- El primer término corrige la **heterocedasticidad**.  
- El segundo término corrige la **autocorrelación** hasta el rezago $q$.  
- Los coeficientes $\beta$ no cambian, pero los errores estándar y las pruebas de significancia se ajustan.\\```{code-cell} ipython3
import pickle
from statsmodels.stats.diagnostic import acorr_ljungbox\\# 1) Cargar el modelo OLS guardado
with open(&quot;ols_model.pkl&quot;, &quot;rb&quot;) as f:
    ols_model = pickle.load(f)\\# 2) Heurística de maxlags según tamaño de muestra (Newey–West)
resid = ols_model.resid
T = len(resid)
heuristic_maxlags = int(np.floor(4 * (T / 100.0) ** (2.0 / 9.0)))
heuristic_maxlags = max(1, heuristic_maxlags)\\# 3) Opcional: ajustar por frecuencia (ejemplo: mensual, cap en 12)
# freq_cap = 12
# maxlags = min(heuristic_maxlags, freq_cap)\\maxlags = heuristic_maxlags\\# 4) Diagnóstico rápido con Ljung–Box en el lag elegido
lb = acorr_ljungbox(resid, lags=[maxlags], return_df=True)
print(f&quot;Ljung–Box p-value at lag={maxlags}: {lb['lb_pvalue'].iloc[-1]:.4f}&quot;)\\# 5) Aplicar HAC (Newey–West)
modelo_hac = ols_model.get_robustcov_results(cov_type=&quot;HAC&quot;, maxlags=maxlags)\\# 6) Resumen con errores estándar corregidos
print(modelo_hac.summary())
```\\## 7.5. Estimadores M Robust (Huber y Tukey)  
### 7.5.1. Aplicación sobre un modelo OLS\\Cuando hacemos regresión OLS, los coeficientes se estiman minimizando:\end{aligned}\end{align} \]</div>
<p>\min_\beta \sum_{i=1}^n (y_i - x_i^\top \beta)^2
$$</p>
<p>Esto hace que OLS sea <strong>muy sensible a valores atípicos</strong>, porque los residuos grandes se elevan al cuadrado.</p>
<p>Los <strong>estimadores M</strong> reducen la influencia de estos valores usando una función de pérdida <span class="math notranslate nohighlight">\( \rho(\cdot) \)</span> que penaliza menos a los outliers.</p>
</section>
</section>
<section id="estimador-m-general">
<h3>7.5.2. Estimador M general<a class="headerlink" href="#estimador-m-general" title="Link to this heading">#</a></h3>
<p>Los estimadores M encuentran los coeficientes resolviendo:</p>
<div class="math notranslate nohighlight">
\[
\hat{\beta} = \arg\min_\beta \sum_{i=1}^n \rho(r_i)
\]</div>
<p>donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( r_i = \frac{y_i - x_i^\top\beta}{\hat{\sigma}}\)</span> es el residuo estandarizado</p></li>
<li><p><span class="math notranslate nohighlight">\( \rho(\cdot)\)</span> es una función de pérdida robusta</p></li>
</ul>
<p>La ecuación de primer orden usa la función <span class="math notranslate nohighlight">\(\psi(r) = \rho'(r)\)</span>, y se resuelve:</p>
<div class="math notranslate nohighlight">
\[
\sum_{i=1}^n \psi(r_i)x_i = 0
\]</div>
</section>
<section id="estimador-de-huber">
<h3>7.5.3. Estimador de Huber<a class="headerlink" href="#estimador-de-huber" title="Link to this heading">#</a></h3>
<p>La función de pérdida es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\rho(r)=
\begin{cases}
\frac{1}{2}r^2 &amp; |r| \le c \\
c|r| - \frac{1}{2}c^2 &amp; |r| &gt; c
\end{cases}
\end{split}\]</div>
<p>La función derivada <span class="math notranslate nohighlight">\(\psi(r)\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\psi(r)=
\begin{cases}
r &amp; |r|\le c \\
c \,\text{sign}(r) &amp; |r| &gt; c
\end{cases}
\end{split}\]</div>
<p>Reduce la influencia de outliers moderados sin descartarlos.</p>
</section>
<section id="estimador-tukey-bisquare-biweight">
<h3>7.5.4. Estimador Tukey Bisquare (Biweight)<a class="headerlink" href="#estimador-tukey-bisquare-biweight" title="Link to this heading">#</a></h3>
<p>Función de pérdida:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\rho(r) =
\begin{cases}
\frac{c^2}{6}\left[1 - \left(1 - \left(\frac{r}{c}\right)^2\right)^3\right] &amp; |r| \le c \\
\frac{c^2}{6} &amp; |r| &gt; c
\end{cases}
\end{split}\]</div>
<p>Derivada <span class="math notranslate nohighlight">\(\psi(r)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\psi(r)=
\begin{cases}
r \left(1 - \left(\frac{r}{c}\right)^2\right)^2 &amp; |r| \le c \\
0 &amp; |r| &gt; c
\end{cases}
\end{split}\]</div>
<p>Los outliers muy extremos reciben peso <span class="math notranslate nohighlight">\(0\)</span> (se excluyen del ajuste).</p>
</section>
<section id="metodo-huber-y-tukey">
<h3>7.5.5. Metodo Huber y Tukey<a class="headerlink" href="#metodo-huber-y-tukey" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recuperar X y y con nombres reales desde el modelo</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">ols_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ols_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">ols_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog_names</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ols_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Recuperar X y y con nombres reales desde el modelo</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">X</span> <span class="o">=</span> <span class="n">ols_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ols_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">feature_names</span> <span class="o">=</span> <span class="n">ols_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog_names</span>

<span class="ne">NameError</span>: name &#39;ols_model&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Huber</span>
<span class="n">huber_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">RLM</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">robust</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">HuberT</span><span class="p">())</span>
<span class="n">huber_results</span> <span class="o">=</span> <span class="n">huber_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Tukey</span>
<span class="n">tukey_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">RLM</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">robust</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">TukeyBiweight</span><span class="p">())</span>
<span class="n">tukey_results</span> <span class="o">=</span> <span class="n">tukey_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Huber ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">huber_results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Tukey ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tukey_results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="bootstrap-temporal-moving-block-bootstrap-2000-replicas">
<h3>7.5.6. Bootstrap temporal (Moving Block Bootstrap) — 2000 réplicas<a class="headerlink" href="#bootstrap-temporal-moving-block-bootstrap-2000-replicas" title="Link to this heading">#</a></h3>
<p>Cuando los datos son temporales (autocorrelación, dependencias en el tiempo) no se puede re-muestrear observaciones individuales de forma independiente sin romper la estructura temporal. El <strong>block bootstrap</strong> re-muestrea <strong>bloques contiguos</strong> de observaciones para preservar la dependencia local.</p>
<p>En el <strong>Moving Block Bootstrap (MBB)</strong>:</p>
<ul class="simple">
<li><p>Elegimos una longitud de bloque <span class="math notranslate nohighlight">\( \ell \)</span>.</p></li>
<li><p>Construimos bloques superpuestos de longitud <span class="math notranslate nohighlight">\( \ell\)</span>: bloque 0 = observaciones [0:<span class="math notranslate nohighlight">\(\ell\)</span>-1], bloque 1 = [1:<span class="math notranslate nohighlight">\(\ell\)</span>], …, hasta el final.</p></li>
<li><p>Para generar una muestra bootstrap de tamaño <span class="math notranslate nohighlight">\(T\)</span>, extraemos <span class="math notranslate nohighlight">\(k = \lceil T / \ell \rceil\)</span> bloques <em>con reemplazo</em> de la lista de bloques y los concatenamos; finalmente recortamos a longitud <span class="math notranslate nohighlight">\(T\)</span>.</p></li>
<li><p>Repetimos esto <span class="math notranslate nohighlight">\(B\)</span> veces (para el ejercicio <span class="math notranslate nohighlight">\(B=2000\)</span>), y para cada muestra bootstrap re-estimamos el modelo OLS y guardamos los coeficientes.</p></li>
<li><p>Las inferencias se hacen sobre la distribución empírica de los coeficientes media, desviación estándar, intervalos percentiles, y demas.</p></li>
</ul>
</section>
<section id="eleccion-de-la-longitud-de-bloque-ell">
<h3>7.5.7. Elección de la longitud de bloque  <span class="math notranslate nohighlight">\(\ell\)</span><a class="headerlink" href="#eleccion-de-la-longitud-de-bloque-ell" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Regla de pulgar común: <span class="math notranslate nohighlight">\(\ell \approx T^{1/3}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parametros para el bootstrap</span>
<span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tamaño de la muestra T = </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2">, variables = </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># número de replicas</span>

<span class="c1"># regla de pulgar para longitud de bloque: l = int(T**(1/3))</span>
<span class="n">l</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">T</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Block length l = </span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2"> (regla ~ T^(1/3))&quot;</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">l</span><span class="p">))</span>  <span class="c1"># número de bloques a concatenar por réplica</span>

<span class="c1"># listado de indice de bloques</span>
<span class="c1"># cada bloque comienza en i y cubre [i, i+l-1]</span>
<span class="n">block_starts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span> <span class="o">-</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">block_starts</span><span class="p">]</span>
<span class="n">n_blocks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número de bloques = </span><span class="si">{</span><span class="n">n_blocks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># funcion para el muestreo</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_mbb_indices</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">n_blocks</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Genera un vector de indices de longitud T usando Moving Block Bootstrap (MBB)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">l</span><span class="p">))</span>
    
    <span class="c1"># elegir k bloques con reemplazo</span>
    <span class="n">chosen_block_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_blocks</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    
    <span class="n">chosen_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">chosen_block_idxs</span><span class="p">])</span>
    
    <span class="c1"># recortar a longitud T</span>
    <span class="n">chosen_indices</span> <span class="o">=</span> <span class="n">chosen_indices</span><span class="p">[:</span><span class="n">T</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">chosen_indices</span>


<span class="c1"># Ejecutar bootstrap y estimar modelo OLS en cada replica</span>
<span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># guardar coeficientes por réplica</span>

<span class="c1"># Para reproducibilidad, puedes fijar semilla:</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>

    <span class="n">idx</span> <span class="o">=</span> <span class="n">generate_mbb_indices</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">n_blocks</span><span class="p">)</span>

    <span class="n">Xb</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">yb</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">model_b</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">yb</span><span class="p">,</span> <span class="n">Xb</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">coefs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">model_b</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># En caso de error numérico, asignar Nan</span>
        <span class="n">coefs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Replica </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> falló: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># quitar replicas malas</span>
<span class="n">valid</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n_valid</span> <span class="o">=</span> <span class="n">valid</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Réplicas válidas: </span><span class="si">{</span><span class="n">n_valid</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">B</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">coefs_valid</span> <span class="o">=</span> <span class="n">coefs</span><span class="p">[</span><span class="n">valid</span><span class="p">,</span> <span class="p">:]</span>

<span class="c1"># metricas para el bootstrap </span>
<span class="n">coef_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coefs_valid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">coef_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">coefs_valid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ci_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">coefs_valid</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">coefs_valid</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;coef_mean&quot;</span><span class="p">:</span> <span class="n">coef_mean</span><span class="p">,</span>
    <span class="s2">&quot;coef_std&quot;</span><span class="p">:</span> <span class="n">coef_std</span><span class="p">,</span>
    <span class="s2">&quot;ci_2.5%&quot;</span><span class="p">:</span> <span class="n">ci_lower</span><span class="p">,</span>
    <span class="s2">&quot;ci_97.5%&quot;</span><span class="p">:</span> <span class="n">ci_upper</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados bootstrap (MBB, 2000 réplicas):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="tabla-comparativa-robustez-de-los-coeficientes-por-metodo">
<h2>7.5.8. Tabla comparativa, robustez de los coeficientes por metodo<a class="headerlink" href="#tabla-comparativa-robustez-de-los-coeficientes-por-metodo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extraccion de coeficientes</span>
<span class="n">ols_coef</span> <span class="o">=</span> <span class="n">ols_model</span><span class="o">.</span><span class="n">params</span>
<span class="n">hac_coef</span> <span class="o">=</span> <span class="n">modelo_hac</span><span class="o">.</span><span class="n">params</span>
<span class="n">huber_coef</span> <span class="o">=</span> <span class="n">huber_results</span><span class="o">.</span><span class="n">params</span>
<span class="n">tukey_coef</span> <span class="o">=</span> <span class="n">tukey_results</span><span class="o">.</span><span class="n">params</span>

<span class="c1"># 2) Bootstrap: ya tienes results_df con:</span>
<span class="c1"># coef_mean, coef_std, ci_2.5%, ci_97.5%</span>
<span class="n">boot_mean</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;coef_mean&quot;</span><span class="p">]</span>

<span class="c1"># 3) Combinar todo en una sola tabla</span>

<span class="n">comparativa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;OLS&quot;</span><span class="p">:</span> <span class="n">ols_coef</span><span class="p">,</span>
    <span class="s2">&quot;HAC (Newey-West)&quot;</span><span class="p">:</span> <span class="n">hac_coef</span><span class="p">,</span>
    <span class="s2">&quot;Huber&quot;</span><span class="p">:</span> <span class="n">huber_coef</span><span class="p">,</span>
    <span class="s2">&quot;Tukey&quot;</span><span class="p">:</span> <span class="n">tukey_coef</span><span class="p">,</span>
    <span class="s2">&quot;Bootstrap Mean&quot;</span><span class="p">:</span> <span class="n">boot_mean</span><span class="p">,</span>
    <span class="s2">&quot;Bootstrap Std&quot;</span><span class="p">:</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;coef_std&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Boot CI 2.5%&quot;</span><span class="p">:</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;ci_2.5%&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Boot CI 97.5%&quot;</span><span class="p">:</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;ci_97.5%&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabla comparativa de robustez de coeficientes:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">comparativa</span>
</pre></div>
</div>
</div>
</div>
<section id="que-significa-que-un-coeficiente-es-robusto">
<h3>¿Qué significa que un coeficiente es “robusto”?<a class="headerlink" href="#que-significa-que-un-coeficiente-es-robusto" title="Link to this heading">#</a></h3>
<p>Un estimador de un coeficiente es robusto cuando al violar alguno de los supuestos del modelo lineal <strong>NO  cambian mucho</strong> su valor ni su significancia, es decir, se mantiene estable.</p>
<p>Los supuestos típicos que se violan en datos reales son:</p>
<ul class="simple">
<li><p>heteroscedasticidad</p></li>
<li><p>autocorrelación</p></li>
<li><p>colas pesadas / outliers</p></li>
<li><p>dependencia temporal</p></li>
<li><p>no normalidad de residuos</p></li>
</ul>
<p>Es por ello que al revisar los diferentes metodos, estos abordan cada uno un aspecto distinto:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Metodo</p></th>
<th class="head"><p>Corrige o soluciona</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>HAC (Newey-West)</strong></p></td>
<td><p>Autocorrelacion + heteroscedasticidad</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Huber (M-estimation)</strong></p></td>
<td><p>Outliers moderados</p></td>
</tr>
<tr class="row-even"><td><p><strong>Tukey biweight</strong></p></td>
<td><p>Outliers severos</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Bootstrap (block bootstrap)</strong></p></td>
<td><p>Distribucion no normal, dependencia temporal</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="criterios-de-robustez-utilizados">
<h3>7.5.9. ¿Criterios de Robustez utilizados?<a class="headerlink" href="#criterios-de-robustez-utilizados" title="Link to this heading">#</a></h3>
<p>En la evaluacion de robustez, se aplica entonces validaciones entre coeficientes de los diferentes metodos para evaluar:</p>
<ol class="arabic simple">
<li><p><strong>Estabilidad del coeficiente entre metodos:</strong><br />
La magbitud del coeficiente debe ser “parecida” (toleremos una variacion del 20%, tomando por base OLS), por lo que si el valor cambia mucho, entonces el efecto no es tan fiable.</p></li>
<li><p><strong>Estabilidad del signo:</strong><br />
El signo del coeficiente debe ser el mismo en todas los metodos. Si se mueve entre positivo y negativo, la relación no es robusta, ya que la relacion no puede indicar “a veces aumenta, aveces disminuye”.</p></li>
<li><p><strong>Estabilidad de la significancia estadística:</strong><br />
Si en para OLS, HACy Huber/Tukey para el coeficiente su <span class="math notranslate nohighlight">\(p-value &lt; 0.05\)</span>, y el intervalo de bootstrap no contiene al 0, el coeficnicoeficiente es <strong>robusto</strong>.</p></li>
<li><p><strong>Ancho del intervalo bootstrap vs tamaño del coeficiente OLS:</strong>
Caundo el intervalo de confianza, en este caso 95%, el ancho o tamaño del inetervalo es igual a la magnitud del coeficiente es reflejo de una alta variabilidad, por lo que no es tan “robusto” entonces.<br />
Es por esto que 1.5 veces (IC95%) la desviacion de bootstrap determinamos sea menor que la magnitud del coeficiente OLS</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_rob</span> <span class="o">=</span> <span class="n">comparativa</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Criterios de robustez</span>

<span class="c1">## signo estable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_sign_stable</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">signs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;OLS&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Huber&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Tukey&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Bootstrap Mean&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">signs</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>  <span class="c1"># todos iguales</span>

<span class="c1">## Consistencia entre metodos (tolerancia 20%)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_consistent_methods</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cambios menores al 20% entre:</span>
<span class="sd">    - OLS vs Huber</span>
<span class="sd">    - OLS vs Tukey</span>
<span class="sd">    - OLS vs Bootstrap Mean</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;OLS&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Huber&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">base</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">base</span><span class="p">),</span>
        <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Tukey&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">base</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">base</span><span class="p">),</span>
        <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Bootstrap Mean&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">base</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ratios</span><span class="p">)</span>

<span class="c1">## Se encuentran dentro del intervalo de bootstrap</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_inside_bootstrap_CI</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">ci_low</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Boot CI 2.5%&#39;</span><span class="p">]</span>
    <span class="n">ci_high</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Boot CI 97.5%&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ci_low</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Huber&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">ci_high</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ci_low</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Tukey&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">ci_high</span><span class="p">)</span>

<span class="c1">##Intervalo bootstrap es estable </span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_bootstrap_stable</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Intervalo no excesivamente ancho.</span>
<span class="sd">    Definimos inestabilidad si: Std &gt; 1.5 * |coef|</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Bootstrap Std&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;OLS&#39;</span><span class="p">])</span>

<span class="c1">#evaluar criterios</span>

<span class="n">df_rob</span><span class="p">[</span><span class="s1">&#39;Signo estable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comparativa</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_sign_stable</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_rob</span><span class="p">[</span><span class="s1">&#39;Métodos consistentes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comparativa</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_consistent_methods</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_rob</span><span class="p">[</span><span class="s1">&#39;Dentro CI bootstrap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comparativa</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_inside_bootstrap_CI</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_rob</span><span class="p">[</span><span class="s1">&#39;Bootstrap estable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comparativa</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_bootstrap_stable</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Criterio final</span>
<span class="n">df_rob</span><span class="p">[</span><span class="s1">&#39;ROBUSTO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">df_rob</span><span class="p">[[</span><span class="s1">&#39;Signo estable&#39;</span><span class="p">,</span><span class="s1">&#39;Métodos consistentes&#39;</span><span class="p">,</span><span class="s1">&#39;Dentro CI bootstrap&#39;</span><span class="p">,</span><span class="s1">&#39;Bootstrap estable&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;Sí&quot;</span><span class="p">,</span> <span class="s2">&quot;No&quot;</span>
<span class="p">)</span>

<span class="c1"># Mostrar tabla final de robustez</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">============================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; TABLA FINAL DE ROBUSTEZ&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;============================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df_rob</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Variables ROBUSTAS, luego de aplicar las validaciones definidas:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_rob</span><span class="p">[</span><span class="n">df_rob</span><span class="p">[</span><span class="s1">&#39;ROBUSTO&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Sí&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="6_diagnostico_supuestos.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">6. Diagnóstico de supuestos del modelo</p>
      </div>
    </a>
    <a class="right-next"
       href="8_validacion_modelo.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">8. Validación y Selección del Modelo</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-librerias">7.1. Importacion de librerias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-de-datos">7.2. Lectura de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-set-training-and-test">7.3 Split data set (Training and test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#errores-estandar-hac-neweywest">7.4 Errores estándar HAC (Newey–West).</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-hac-neweywest">7.4.1. Método HAC (Newey–West)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-ols">7.4.2. Modelo OLS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-hac">7.4.3. Estimador HAC</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-m-general">7.5.2. Estimador M general</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-de-huber">7.5.3. Estimador de Huber</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimador-tukey-bisquare-biweight">7.5.4. Estimador Tukey Bisquare (Biweight)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-huber-y-tukey">7.5.5. Metodo Huber y Tukey</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-temporal-moving-block-bootstrap-2000-replicas">7.5.6. Bootstrap temporal (Moving Block Bootstrap) — 2000 réplicas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eleccion-de-la-longitud-de-bloque-ell">7.5.7. Elección de la longitud de bloque  <span class="math notranslate nohighlight">\(\ell\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-comparativa-robustez-de-los-coeficientes-por-metodo">7.5.8. Tabla comparativa, robustez de los coeficientes por metodo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#que-significa-que-un-coeficiente-es-robusto">¿Qué significa que un coeficiente es “robusto”?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criterios-de-robustez-utilizados">7.5.9. ¿Criterios de Robustez utilizados?</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gloria Bastidas - Daniel Carbono - Luis Perez
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>